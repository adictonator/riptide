{%- capture flickity_options -%}
    {
    "prevNextButtons": false,
                                                                                                                                                                                                                          "wrapAround": true,
                                                                                                                                                                                                                          "dragThreshold": 16,
                                                                                                                                                                                                                          "pageDots":{%- if section.blocks.size > 1 -%}true{%- else -%}false{%- endif -%},
    "autoPlay":
    {%- if section.settings.autoplay -%}
        {{ section.settings.cycle_speed | times: 1000 }}{%- else -%}false{%- endif -%}
    }
{%- endcapture -%}

{%- assign should_show_nav = false -%}

{%- for block in section.blocks -%}
    {%- if block.settings.logo -%}
        {%- assign should_show_nav = true -%}
        {%- break -%}
    {%- endif -%}
{%- endfor -%}

<div data-section-id="{{ section.id }}">
    <div id="_x">
        {%- for block in section.blocks -%}
            <div class="w-full text-center">
                {%- if block.settings.quote != blank -%}
                    <div class="text-2xl">
                        {{ block.settings.quote }}
                    </div>
                {%- endif -%}

                {%- if block.settings.logo != blank -%}
                    <img
                        alt="{{ block.settings.logo.alt | escape }}"
                        class="Testimonial__Logo hidden-lap-and-up mt-5 mx-auto"
                        src="{{ block.settings.logo | img_url: '300x' }}">
                {%- endif -%}
            </div>
        {%- endfor -%}
    </div>

    {%- comment -%}
        {%- if should_show_nav -%}
        <div class='TestimonialNav hidden-pocket'>
        {%- for block in section.blocks -%}
        {%- if block.settings.logo != blank -%}
        <img
        alt="{{ block.settings.logo.alt | escape }}"
        class="TestimonialNav__Item {% if forloop.first %}is-selected{% endif %}"
        data-index="{{ forloop.index0 }}"
        src="{{ block.settings.logo | img_url: "300x" }}">
        {%- endif -%}
        {%- endfor -%}
        </div>
        {%- endif -%}
    {%- endcomment -%}
</div>

<style>
    #shopify-section-{{ section.id }}{
        color: {{ section.settings.text_color }};
        background: {{ section.settings.background }};
    }
</style>

{%- javascript -%}
    $ (document).ready (function () {
        $ ('#_x').slick ({
            slidesToShow: 1,
            slidesToScroll: 1,
            autoplay: true,
            autoplaySpeed: 3000,

            // adaptiveHeight: true,
            arrows: false
        });
    });
{% endjavascript %}
{%- schema -%}
    {
        "name": "Testimonials",
        "class": "section py-20",
        "tag": "section",
        "max_blocks": 6,
        "settings": [
            {
                "type": "checkbox",
                "id": "autoplay",
                "label": "Auto rotate between testimonials",
                "default": true
            },
            {
                "type": "range",
                "id": "cycle_speed",
                "min": 3,
                "max": 8,
                "step": 1,
                "unit": "sec",
                "label": "Change testimonials every",
                "default": 5
            },
            {
                "type": "color",
                "id": "background",
                "label": "Background",
                "default": "#eaeaea"
            },
            {
                "type": "color",
                "id": "text_color",
                "label": "Text",
                "default": "#1c1b1b"
            }
        ],
        "blocks": [
            {
                "type": "testimonial",
                "name": "Testimonial",
                "settings": [
                    {
                        "type": "image_picker",
                        "id": "logo",
                        "label": "Logo",
                        "info": "340 x 80px .jpg recommended"
                    },
                    {
                        "type": "richtext",
                        "id": "quote",
                        "label": "Quote",
                        "default": "<p>Share what your customers are saying about your products, your company...</p>",
                        "info": "For best results, keep the word count consistent in each quote."
                    }
                ]
            }
        ],
        "presets": [
            {
                "category": "Text",
                "name": "Testimonials",
                "settings": {},
                "blocks": [
                    {
                        "type": "testimonial",
                        "settings": {}
                    },
                    {
                        "type": "testimonial",
                        "settings": {}
                    },
                    {
                        "type": "testimonial",
                        "settings": {}
                    }
                ]
            }
        ]
    }
{% endschema %}
